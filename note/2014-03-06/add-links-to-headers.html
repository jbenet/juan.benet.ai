<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Add Links to Headers - juan.benet.ai</title>
  <meta name="viewport" content="width=device-width">

  <!-- CSS -->
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet" />
  <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="/css/syntax.css">
  <link href="/css/main.css" media="all" rel="stylesheet" type="text/css" />

  <!-- jQuery for inlined $ -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" ></script>

</head>
<body>

<div class="site">

  <div class="content markdown">
  <h2>
  <small><a href="/">Juan Benet</a> /
  <a class="category" href="/note">
  note</a> /</small>
  Add Links to Headers</h2>
<p class="meta">2014-03-06</p>

<div class="post">
<p><a href="https://github.com/jbenet/jbenet.github.com/commits/source/_posts/2014-03-05-add-links-to-headers.md">Version history</a>.</p>

<p>I&#39;ve always likes how <a href="http://github.com">github</a> adds on-hover links to headers on their rendered markdown:</p>

<hr>

<p><img src="http://note.io/1mXzAgn" alt="gh-makrdown-links"></p>

<hr>

<p>I couldn&#39;t find markdown renderers that included it. So, I wrote my post-processing js to make them. With any luck, this website should still show it in action. Below&#39;s the code.</p>

<h2 id="here-39-s-the-js-assumes-and-_-are-defined">Here&#39;s the <code>js</code> (assumes <a href="http://jquery.com/"><code>$</code></a> and <a href="http://underscorejs.org"><code>_</code></a> are defined):</h2>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// Modify this template to add or change links.</span>
  <span class="kd">var</span> <span class="nx">links</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s1">'\
    &lt;div class="header-links"&gt;\
      &lt;a href="#&lt;%= id %&gt;"&gt;&lt;i class="icon icon-link"&gt;&lt;/i&gt;&lt;/a&gt;\
    &lt;/div&gt;\
  '</span><span class="p">);</span>

  <span class="c1">// If your headers dont already have ids, use this slug fn</span>
  <span class="kd">var</span> <span class="nx">slugize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">title</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">title</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">[^\w</span><span class="sr"> ()</span><span class="se">]</span><span class="sr">+/g</span><span class="p">,</span><span class="s1">''</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/ +/g</span><span class="p">,</span><span class="s1">'-'</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Modify the ':header' selector to apply to other elems</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">':header'</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">h</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// Add an id, if it doesn't have one.</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">(</span><span class="nx">h</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'id'</span><span class="p">))</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">h</span><span class="p">).</span><span class="nx">text</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">[^</span><span class="sr">A-Za-z0-9_</span><span class="se">]</span><span class="sr">+/g</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">)</span>
      <span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^-+|-+$/g</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
      <span class="nx">$</span><span class="p">(</span><span class="nx">h</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span> <span class="nx">slugize</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">h</span><span class="p">).</span><span class="nx">text</span><span class="p">()));</span>
    <span class="p">}</span>

    <span class="c1">// Add the link div</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">h</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">links</span><span class="p">({</span>
      <span class="na">id</span><span class="p">:</span> <span class="nx">$</span><span class="p">(</span><span class="nx">h</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span>
    <span class="p">})));</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div>
<h2 id="here-39-s-the-less-assumes-fontawesome-icons-css">Here&#39;s the <code>less</code> (assumes FontAwesome icons <code>css</code>):</h2>
<div class="highlight"><pre><code class="language-less" data-lang="less">h1, h2, h3, h4, h5, h6 {
  &amp;:hover .header-links a {
    text-decoration: none;
    opacity: 0.4;
    color: gray;
  }

  .header-links {
    float: left;
    text-align: right;
    margin-left: -40px;
    padding-right: 10px;
    width: 40px;

    a {
      text-decoration: none;
      opacity: 0.0; // show on hover
      color: gray;
    }

    a:hover, a:active, a:focus {
      text-decoration: none;
      opacity: 0.6;
      color: #428bca;
    }
  }
}
</code></pre></div>
<h2 id="and-it-looks-like-this">And it looks like this:</h2>

<hr>

<p><img src="http://note.io/1mXBOMJ" alt="my-markdown-links"></p>

</div>

  </div>


 <!-- Footer -->
  <footer>
    <div id="site-map">
      <h5>juan.benet.ai</h5>
      <ul class="links no-bullet">
        <li><a href="/">Home</a></li>
        <li><a href="/about">About</a></li>
      </ul>
    </div>
    <div id="contact-me">
      <h5>Contact</h5>
      <ul class="links no-bullet">
        <li><a href="https://twitter.com/intent/user?screen_name=juanbenet" target="_blank"><i class="icon-twitter"></i> @juanbenet</a></li>
        <li><a href="https://github.com/jbenet" id="new-issue" target="_blank"><i class="icon-github"></i> github.com/jbenet</a></li>
        <li>
        <a href="http://www.google.com/recaptcha/mailhide/d?k=01LaO8uNTV8Ss8kghGlxHXCw==&amp;c=eEwF2u87Cdkgipi5COLbnA=="
        onclick="window.open('http://www.google.com/recaptcha/mailhide/d?k\07501LaO8uNTV8Ss8kghGlxHXCw\75\75\46c\75eEwF2u87Cdkgipi5COLbnA\75\075', '', 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=500,height=300'); return false;"
        title="Reveal this e-mail address"><i class="icon-envelope"></i>
        click-to-reveal@benet.ai</a>
        </li>
      </ul>
    </div>
  </footer>

</div>

<!-- cdnlibs -->
<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.1/underscore-min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<script src="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css"></script>

<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48626381-1', 'benet.ai');
  ga('send', 'pageview');

</script>

<script type="text/javascript">
$(document).ready(function() {
  // Modify this template to add or change links.
  var links = _.template('\
    <div class="header-links">\
      <a href="#<%= id %>"><i class="icon icon-link"></i></a>\
    </div>\
  ');

  // If your headers dont already have ids, use this slug fn
  var slugize = function(title) {
    return title.toLowerCase()
      .replace(/[^\w ()]+/g,'')
      .replace(/ +/g,'-');
  }

  // Modify the ':header' selector to apply to other elems
  $(':header').each(function(i, h) {

    // Add an id, if it doesn't have one.
    if (!$(h).attr('id')) {
      var id = $(h).text().replace(/[^A-Za-z0-9_]+/g, '-')
      id = id.replace(/^-+|-+$/g, '')
      $(h).attr('id', slugize($(h).text()));
    }

    // Add the link div
    $(h).append($(links({
      id: $(h).attr('id')
    })));
  });
});
</script>

</body>
</html>
